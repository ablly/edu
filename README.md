# EduPilot - AIé©±åŠ¨çš„æ•™è‚²åæ§ç³»ç»Ÿ

<div align="center">

![EduPilot Logo](static/images/logo.png)

**ä¸€ä¸ªç°ä»£åŒ–çš„ã€åŠŸèƒ½å®Œå–„çš„K12æ•™è‚²ç®¡ç†ç³»ç»Ÿ**

[![License](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)
[![Python](https://img.shields.io/badge/python-3.7+-blue.svg)](https://www.python.org/)
[![Flask](https://img.shields.io/badge/flask-2.3+-green.svg)](https://flask.palletsprojects.com/)
[![PostgreSQL](https://img.shields.io/badge/database-PostgreSQL-blue.svg)](https://www.postgresql.org/)

</div>

---

## ğŸ“– é¡¹ç›®ç®€ä»‹

EduPilot æ˜¯ä¸€ä¸ªé›†æˆäº†AIæŠ€æœ¯çš„æ•™è‚²ç®¡ç†ç³»ç»Ÿï¼Œä¸“ä¸ºK12æ•™è‚²åœºæ™¯è®¾è®¡ã€‚ç³»ç»Ÿæä¾›å­¦ç”Ÿç®¡ç†ã€ä½œä¸šç®¡ç†ã€AIè¾…åŠ©æ•™å­¦ã€æ™ºèƒ½å‡ºé¢˜ã€è§†é¢‘æ€»ç»“ã€è¾…åŠ©ç¼–ç¨‹ç­‰å¤šç§åŠŸèƒ½ï¼Œå¸®åŠ©æ•™å¸ˆæé«˜æ•™å­¦æ•ˆç‡ï¼Œæå‡å­¦ç”Ÿå­¦ä¹ ä½“éªŒã€‚

### âœ¨ æ ¸å¿ƒç‰¹æ€§

#### ğŸ“ æ•™å­¦ç®¡ç†
- **å­¦ç”Ÿç®¡ç†**ï¼šå®Œæ•´çš„å­¦ç”Ÿä¿¡æ¯ç®¡ç†ã€ç­çº§ç®¡ç†
- **ä½œä¸šç®¡ç†**ï¼šä½œä¸šå‘å¸ƒã€æäº¤ã€æ‰¹æ”¹ã€æˆç»©ç»Ÿè®¡
- **è¿›åº¦è·Ÿè¸ª**ï¼šå¯è§†åŒ–å­¦ä¹ è¿›åº¦å›¾è¡¨

#### ğŸ¤– AIèƒ½åŠ›
- **æ™ºèƒ½ç­”ç–‘**ï¼šæ”¯æŒå¤šè½®å¯¹è¯ï¼Œä¸Šä¸‹æ–‡ç†è§£
- **æ™ºèƒ½å‡ºé¢˜**ï¼šæ ¹æ®çŸ¥è¯†ç‚¹è‡ªåŠ¨ç”Ÿæˆè¯•é¢˜
- **æ™ºèƒ½è®²ä¹‰**ï¼šAIç”Ÿæˆæ•™å­¦è®²ä¹‰å’Œè¯¾ä»¶
- **è§†é¢‘æ€»ç»“**ï¼šè‡ªåŠ¨æå–è§†é¢‘å…³é”®ä¿¡æ¯
- **è¾…åŠ©ç¼–ç¨‹**ï¼šä»£ç è§£é‡Šã€è°ƒè¯•ã€ä¼˜åŒ–å»ºè®®

#### ğŸ’ ä¼šå‘˜ç³»ç»Ÿ
- **å¤šå±‚çº§ä¼šå‘˜**ï¼šå…è´¹ç‰ˆã€å‘¨å¡ã€æœˆå¡ã€å¹´å¡
- **æ—©é¸Ÿä¼˜æƒ **ï¼šé™æ—¶é™é‡ä¼˜æƒ æ´»åŠ¨
- **åŠŸèƒ½é™é¢**ï¼šç²¾ç»†åŒ–çš„åŠŸèƒ½ä½¿ç”¨æ§åˆ¶
- **æ”¯ä»˜é›†æˆ**ï¼šæ”¯æŒæ”¯ä»˜å®å®æ—¶æ”¯ä»˜

#### ğŸ”’ å®‰å…¨ä¿éšœ
- **CSRFä¿æŠ¤**ï¼šé˜²æ­¢è·¨ç«™è¯·æ±‚ä¼ªé€ 
- **é™æµæ§åˆ¶**ï¼šAPIé¢‘ç‡é™åˆ¶
- **å¯†ç å¼ºåº¦**ï¼šå¼ºå¯†ç ç­–ç•¥
- **è´¦æˆ·é”å®š**ï¼šé˜²æš´åŠ›ç ´è§£
- **XSSé˜²æŠ¤**ï¼šè¾“å…¥æ¸…ç†å’Œå†…å®¹å®‰å…¨

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- **Python**: 3.7+
- **æ•°æ®åº“**: PostgreSQL 12+ (æ¨è) æˆ– SQLite (å¼€å‘ç¯å¢ƒ)
- **æ“ä½œç³»ç»Ÿ**: Windows / Linux / macOS

### å®‰è£…æ­¥éª¤

#### 1. å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/your-username/edupilot.git
cd edupilot
```

#### 2. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ

```bash
# Windows
python -m venv venv
venv\Scripts\activate

# Linux/macOS
python3 -m venv venv
source venv/bin/activate
```

#### 3. å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

#### 4. é…ç½®ç¯å¢ƒå˜é‡

å¤åˆ¶ç¯å¢ƒé…ç½®ç¤ºä¾‹æ–‡ä»¶ï¼š

```bash
cp env.example .env
```

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œå¡«å…¥å¿…è¦çš„é…ç½®ï¼š

```env
# æ•°æ®åº“è¿æ¥
DATABASE_URL=postgresql://edupilot_user:password@localhost:5432/edupilot_db

# å¯†é’¥ï¼ˆè¯·ä½¿ç”¨éšæœºå­—ç¬¦ä¸²ï¼‰
SECRET_KEY=your_secret_key_here

# AIæœåŠ¡å¯†é’¥
DASHSCOPE_API_KEY=your_api_key
KIMI_API_KEY=your_api_key
XUNFEI_APP_ID=your_app_id

# æ”¯ä»˜å®é…ç½®
ALIPAY_APP_ID=your_alipay_app_id
```

#### 5. åˆå§‹åŒ–æ•°æ®åº“

```bash
# å¦‚æœä½¿ç”¨PostgreSQLï¼Œå…ˆåˆ›å»ºæ•°æ®åº“
# psql -U postgres
# CREATE DATABASE edupilot_db;
# CREATE USER edupilot_user WITH PASSWORD 'password';
# GRANT ALL PRIVILEGES ON DATABASE edupilot_db TO edupilot_user;

# åˆå§‹åŒ–ä¼šå‘˜å¥—é¤
python init_pricing.py
```

#### 6. è¿è¡Œåº”ç”¨

```bash
# å¼€å‘ç¯å¢ƒ
python app.py

# ç”Ÿäº§ç¯å¢ƒï¼ˆä½¿ç”¨Gunicornï¼‰
gunicorn -c deploy/gunicorn/gunicorn_config.py app:app
```

è®¿é—® http://localhost:5000

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
EduPilot/
â”œâ”€â”€ app.py                          # ä¸»åº”ç”¨æ–‡ä»¶
â”œâ”€â”€ config.py                       # é…ç½®æ–‡ä»¶
â”œâ”€â”€ models.py                       # æ•°æ®æ¨¡å‹
â”œâ”€â”€ models_membership.py            # ä¼šå‘˜ç³»ç»Ÿæ¨¡å‹
â”œâ”€â”€ membership_utils.py             # ä¼šå‘˜å·¥å…·å‡½æ•°
â”œâ”€â”€ routes_payment.py               # æ”¯ä»˜è·¯ç”±
â”œâ”€â”€ init_pricing.py                 # åˆå§‹åŒ–ä»·æ ¼æ•°æ®
â”‚
â”œâ”€â”€ templates/                      # HTMLæ¨¡æ¿
â”‚   â”œâ”€â”€ errors/                     # é”™è¯¯é¡µé¢
â”‚   â”œâ”€â”€ index.html                  # é¦–é¡µ
â”‚   â”œâ”€â”€ students.html               # å­¦ç”Ÿç®¡ç†
â”‚   â”œâ”€â”€ membership.html             # ä¼šå‘˜ä¸­å¿ƒ
â”‚   â”œâ”€â”€ payment.html                # æ”¯ä»˜é¡µé¢
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ static/                         # é™æ€èµ„æº
â”‚   â”œâ”€â”€ css/                        # æ ·å¼æ–‡ä»¶
â”‚   â”œâ”€â”€ js/                         # JavaScriptæ–‡ä»¶
â”‚   â””â”€â”€ images/                     # å›¾ç‰‡èµ„æº
â”‚
â”œâ”€â”€ utils/                          # å·¥å…·æ¨¡å—
â”‚   â”œâ”€â”€ security.py                 # å®‰å…¨å·¥å…·
â”‚   â””â”€â”€ payment_alipay.py           # æ”¯ä»˜å®å®¢æˆ·ç«¯
â”‚
â”œâ”€â”€ scripts/                        # ç®¡ç†è„šæœ¬
â”‚   â”œâ”€â”€ migrate_to_postgresql.py   # æ•°æ®åº“è¿ç§»
â”‚   â”œâ”€â”€ verify_postgresql_migration.py  # è¿ç§»éªŒè¯
â”‚   â””â”€â”€ backup_postgresql.py        # æ•°æ®åº“å¤‡ä»½
â”‚
â”œâ”€â”€ deploy/                         # éƒ¨ç½²é…ç½®
â”‚   â”œâ”€â”€ nginx/                      # Nginxé…ç½®
â”‚   â”œâ”€â”€ gunicorn/                   # Gunicorné…ç½®
â”‚   â””â”€â”€ supervisor/                 # Supervisoré…ç½®
â”‚
â”œâ”€â”€ logs/                           # æ—¥å¿—ç›®å½•
â”œâ”€â”€ data/                           # æ•°æ®ç›®å½•
â””â”€â”€ docs/                           # æ–‡æ¡£ç›®å½•
```

---

## ğŸ¯ åŠŸèƒ½æ¨¡å—

### 1. ç”¨æˆ·ç³»ç»Ÿ
- ç”¨æˆ·æ³¨å†Œ/ç™»å½•
- å¯†ç ä¿®æ”¹
- ä¼šå‘˜ä¿¡æ¯æŸ¥çœ‹

### 2. å­¦ç”Ÿç®¡ç†
- å­¦ç”Ÿåˆ—è¡¨æŸ¥çœ‹
- æ·»åŠ /ç¼–è¾‘/åˆ é™¤å­¦ç”Ÿ
- æ‰¹é‡å¯¼å…¥å­¦ç”Ÿ

### 3. ä½œä¸šç³»ç»Ÿ
- ä½œä¸šå‘å¸ƒä¸ç®¡ç†
- å­¦ç”Ÿä½œä¸šæäº¤
- æˆç»©ç»Ÿè®¡ä¸åˆ†æ

### 4. AIåŠŸèƒ½
- **æ™ºèƒ½ç­”ç–‘**ï¼šå¤šè½®å¯¹è¯ï¼Œæ”¯æŒè¯¾ç¨‹ã€é¢˜å‹é€‰æ‹©
- **æ™ºèƒ½å‡ºé¢˜**ï¼šæ ¹æ®çŸ¥è¯†ç‚¹ç”Ÿæˆé¢˜ç›®
- **æ™ºèƒ½è®²ä¹‰**ï¼šç”Ÿæˆæ•™å­¦ææ–™
- **è§†é¢‘æ€»ç»“**ï¼šæå–è§†é¢‘å…³é”®ä¿¡æ¯
- **è¾…åŠ©ç¼–ç¨‹**ï¼šä»£ç è§£é‡Šå’Œä¼˜åŒ–

### 5. ä¼šå‘˜ç³»ç»Ÿ
- æ—©é¸Ÿä¼˜æƒ ï¼ˆé™é‡50äººï¼Œ3æ¡£ä»·æ ¼ï¼‰
- æ ‡å‡†å¥—é¤ï¼ˆå‘¨/æœˆ/å¹´å¡ï¼‰
- ä½¿ç”¨é™é¢ç®¡ç†
- ä¼šå‘˜åˆ°æœŸè‡ªåŠ¨é™çº§

### 6. æ”¯ä»˜ç³»ç»Ÿ
- æ”¯ä»˜å®åœ¨çº¿æ”¯ä»˜
- è®¢å•ç®¡ç†
- æ”¯ä»˜å›è°ƒå¤„ç†
- è®¢å•æŸ¥è¯¢å’Œå–æ¶ˆ

---

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### åç«¯
- **Webæ¡†æ¶**: Flask 2.3+
- **æ•°æ®åº“**: PostgreSQL / SQLite
- **ORM**: SQLAlchemy
- **è®¤è¯**: Flask-Login
- **å®‰å…¨**: Flask-WTF (CSRF), Flask-Limiter (é™æµ)
- **æ”¯ä»˜**: Alipay SDK

### å‰ç«¯
- **æ¨¡æ¿å¼•æ“**: Jinja2
- **æ ·å¼**: Custom CSS (å“åº”å¼è®¾è®¡)
- **è„šæœ¬**: Vanilla JavaScript
- **å›¾è¡¨**: Chart.js

### AIæœåŠ¡
- **é€šä¹‰åƒé—®**: DashScope API
- **Kimi**: Moonshot API
- **è®¯é£æ˜Ÿç«**: XFYUN API

### éƒ¨ç½²
- **WebæœåŠ¡å™¨**: Nginx
- **WSGIæœåŠ¡å™¨**: Gunicorn
- **è¿›ç¨‹ç®¡ç†**: Supervisor
- **å®¹å™¨åŒ–**: Docker (å¯é€‰)

---

## ğŸ“Š æ•°æ®åº“è®¾è®¡

### æ ¸å¿ƒè¡¨
- **users**: ç”¨æˆ·è¡¨
- **students**: å­¦ç”Ÿè¡¨
- **assignment**: ä½œä¸šè¡¨
- **question_bank**: é¢˜åº“è¡¨
- **question_submission**: é¢˜ç›®æäº¤è¡¨

### ä¼šå‘˜ç³»ç»Ÿè¡¨
- **membership_tiers**: ä¼šå‘˜å¥—é¤è¡¨
- **user_memberships**: ç”¨æˆ·ä¼šå‘˜å…³ç³»è¡¨
- **payment_transactions**: æ”¯ä»˜äº¤æ˜“è¡¨
- **usage_logs**: ä½¿ç”¨æ—¥å¿—è¡¨

### è¾…åŠ©è¡¨
- **conversations**: å¯¹è¯è®°å½•è¡¨
- **conversation_messages**: å¯¹è¯æ¶ˆæ¯è¡¨
- **video_notes**: è§†é¢‘ç¬”è®°è¡¨
- **login_attempts**: ç™»å½•å°è¯•è¡¨

---

## ğŸ”§ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡

æ‰€æœ‰é…ç½®é€šè¿‡ç¯å¢ƒå˜é‡æˆ– `.env` æ–‡ä»¶ç®¡ç†ï¼š

| å˜é‡å | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|
| `DATABASE_URL` | æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸² | `postgresql://user:pass@localhost/db` |
| `SECRET_KEY` | Flaskå¯†é’¥ | éšæœºå­—ç¬¦ä¸² |
| `DASHSCOPE_API_KEY` | é€šä¹‰åƒé—®APIå¯†é’¥ | `sk-xxx` |
| `ALIPAY_APP_ID` | æ”¯ä»˜å®åº”ç”¨ID | `2021xxx` |
| `FLASK_ENV` | è¿è¡Œç¯å¢ƒ | `development` / `production` |

å®Œæ•´é…ç½®é¡¹è¯·å‚è€ƒ `env.example`

### ä¼šå‘˜é…ç½®

ä¼šå‘˜åŠŸèƒ½ä½¿ç”¨é™é¢å¯åœ¨ç¯å¢ƒå˜é‡ä¸­é…ç½®ï¼š

```env
FREE_USER_DAILY_LIMIT_ANSWER=5
FREE_USER_DAILY_LIMIT_GENERATE_QUESTION=3
FREE_USER_DAILY_LIMIT_GENERATE_LECTURE=2
```

---

## ğŸš¢ éƒ¨ç½²æŒ‡å—

è¯¦ç»†çš„éƒ¨ç½²æ–‡æ¡£è¯·å‚è€ƒï¼š
- [DEPLOYMENT.md](DEPLOYMENT.md) - å®Œæ•´éƒ¨ç½²æŒ‡å—
- [PostgreSQLè¿ç§»æŒ‡å—.md](PostgreSQLè¿ç§»æŒ‡å—.md) - æ•°æ®åº“è¿ç§»
- [æ”¯ä»˜æ¥å…¥æŒ‡å—.md](æ”¯ä»˜æ¥å…¥æŒ‡å—.md) - æ”¯ä»˜å®é›†æˆ

### ç”Ÿäº§ç¯å¢ƒå¿«é€Ÿéƒ¨ç½²

```bash
# 1. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 2. é…ç½®ç¯å¢ƒå˜é‡
cp env.example .env
nano .env

# 3. åˆå§‹åŒ–æ•°æ®åº“
python init_pricing.py

# 4. ä½¿ç”¨Gunicornå¯åŠ¨
gunicorn -c deploy/gunicorn/gunicorn_config.py app:app

# 5. é…ç½®Nginxåå‘ä»£ç†
sudo cp deploy/nginx/nginx.conf /etc/nginx/sites-available/edupilot
sudo ln -s /etc/nginx/sites-available/edupilot /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl reload nginx

# 6. é…ç½®Supervisorè¿›ç¨‹ç®¡ç†
sudo cp deploy/supervisor/edupilot.conf /etc/supervisor/conf.d/
sudo supervisorctl reread
sudo supervisorctl update
```

---

## ğŸ§ª æµ‹è¯•

```bash
# è¿è¡Œæµ‹è¯•ï¼ˆTODOï¼šæ·»åŠ æµ‹è¯•å¥—ä»¶ï¼‰
python -m pytest tests/

# ä»£ç è¦†ç›–ç‡
pytest --cov=. --cov-report=html
```

---

## ğŸ“ APIæ–‡æ¡£

### ç”¨æˆ·API
- `POST /api/register` - ç”¨æˆ·æ³¨å†Œ
- `POST /api/login` - ç”¨æˆ·ç™»å½•
- `POST /api/change-password` - ä¿®æ”¹å¯†ç 

### ä¼šå‘˜API
- `GET /api/membership/status` - è·å–ä¼šå‘˜çŠ¶æ€
- `GET /api/membership/tiers` - è·å–å¥—é¤åˆ—è¡¨
- `GET /api/membership/usage` - è·å–ä½¿ç”¨æƒ…å†µ

### æ”¯ä»˜API
- `POST /api/payment/create` - åˆ›å»ºè®¢å•
- `GET /api/payment/query/<order_id>` - æŸ¥è¯¢è®¢å•
- `POST /api/payment/alipay/callback` - æ”¯ä»˜å›è°ƒ
- `POST /api/payment/cancel/<order_id>` - å–æ¶ˆè®¢å•

### AI API
- `POST /api/ai/answer-questions` - æ™ºèƒ½ç­”ç–‘
- `POST /api/ai/generate-questions` - æ™ºèƒ½å‡ºé¢˜
- `POST /api/ai/generate-lecture` - ç”Ÿæˆè®²ä¹‰
- `POST /api/ai/video-summary` - è§†é¢‘æ€»ç»“
- `POST /api/ai/code-assist` - è¾…åŠ©ç¼–ç¨‹

---

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

- **æ•°æ®åº“ä¼˜åŒ–**ï¼šç´¢å¼•ä¼˜åŒ–ã€æŸ¥è¯¢ä¼˜åŒ–
- **ç¼“å­˜ç­–ç•¥**ï¼šRedisç¼“å­˜ï¼ˆå¯é€‰ï¼‰
- **é™æ€èµ„æº**ï¼šCDNåŠ é€Ÿã€æ–‡ä»¶ç‰ˆæœ¬åŒ–
- **è¿æ¥æ± **ï¼šæ•°æ®åº“è¿æ¥æ± ç®¡ç†
- **è´Ÿè½½å‡è¡¡**ï¼šå¤šworkerå¹¶å‘å¤„ç†

---

## ğŸ” å®‰å…¨ç‰¹æ€§

- **CSRFä¿æŠ¤**ï¼šæ‰€æœ‰è¡¨å•éƒ½æœ‰CSRFä»¤ç‰Œ
- **XSSé˜²æŠ¤**ï¼šè¾“å…¥è¿‡æ»¤å’Œè¾“å‡ºè½¬ä¹‰
- **SQLæ³¨å…¥**ï¼šä½¿ç”¨ORMå‚æ•°åŒ–æŸ¥è¯¢
- **å¯†ç åŠ å¯†**ï¼šBcryptåŠ å¯†å­˜å‚¨
- **é™æµä¿æŠ¤**ï¼šAPIé¢‘ç‡é™åˆ¶
- **è´¦æˆ·é”å®š**ï¼šé˜²æš´åŠ›ç ´è§£
- **å®‰å…¨å¤´éƒ¨**ï¼šCSPã€X-Frame-Optionsç­‰

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ä»£ç ï¼è¯·éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š

1. Forkæœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æäº¤Pull Request

---

## ğŸ“œ å¼€æºåè®®

æœ¬é¡¹ç›®é‡‡ç”¨ [MIT License](LICENSE) åè®®

---

## ğŸ“§ è”ç³»æ–¹å¼

- **ä½œè€…**: EduPilot Team
- **é‚®ç®±**: 3533912007@qq.com
- **å®˜ç½‘**: https://edupilot.com
- **é—®é¢˜åé¦ˆ**: [GitHub Issues](https://github.com/your-username/edupilot/issues)

---

## ğŸ™ è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®å’ŒæœåŠ¡ï¼š

- [Flask](https://flask.palletsprojects.com/) - Webæ¡†æ¶
- [PostgreSQL](https://www.postgresql.org/) - æ•°æ®åº“
- [é˜¿é‡Œäº‘é€šä¹‰åƒé—®](https://dashscope.aliyun.com/) - AIæœåŠ¡
- [Kimi](https://platform.moonshot.cn/) - AIæœåŠ¡
- [è®¯é£æ˜Ÿç«](https://www.xfyun.cn/) - AIæœåŠ¡

---

<div align="center">

**â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ªæ˜Ÿæ ‡ï¼**

Made with â¤ï¸ by EduPilot Team

</div>




#   e d u  
 